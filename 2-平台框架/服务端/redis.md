##### 1、nosql的分类
键值对存储:redis/memcached
文档型数据库:mongoDB
列存储数据库:HBase
图关系数据库:

#### 2、安装
在线安装:`sudo apt-get install redis-server
redis.conf默认位置/etc/redis/redis.conf

连接:`/usr/bin/redis-cli -p 6379`
ping 命令测试连接

`ps -ef|grep redis` 查看redis-server的端口

性能测试工具:`redis-benchmark -c 100 -n 10000

##### 3、基础
默认由16个数据库  配置文件中
`select`指令可以切换数据库`

redis为单线程

##### 4、数据类型

| 类型 | 说明 |
|--------|--------|
|    string    |    可以包含任何数据 最大512M    |
|    List    |    双向链表  可以使用range完成分页功能  |
|    Set    |    元素不重复    |
|    Hash    |    Map结构    |
|    Sorted    |    有序的Set    |
|    Hyperlog    |    求并集 一般用于计数   |
|    GeoSpatial    |    操作经纬度   |
|    bitmap    |    位存储    |

##### 4.1 key的设计原则
-----待添加

#### 5、发布订阅
发送者(pub)发送消息，订阅者(sub)接收消息  都是在客户端
Redis 客户端可以订阅任意数量的频道

#### 6、事务
`MULTI` 开始一个事务， 然后将多个命令入队到事务中， 最后由 `EXEC` 命令触发事务， 一并执行事务中的所有命令
事务中任意命令执行失败，其余的命令依然被执行

#### 7、数据备份与恢复
`SAVE`用于创建当前数据库的备份
恢复数据，将备份文件 (dump.rdb) 移动到 redis 安装目录并启动即可。获取 redis 目录可以使用 CONFIG 命令

#### 8、持久化
##### 8.1 RDB文件
参数可以在redis.conf 配置
指定时间间隔 将内存数据写入磁盘
恢复是将磁盘的文件直接读入内存

##### 8.2 AOF文件
记录每一条增删改指令 恢复时 重新执行一次

#### 9、集群
redisconf  replicaof字段
主从复制   读写分离  主写从读

##### 哨兵模式
redis-sentinel
多哨兵模式

如果主机挂掉再次启动 会变为从机

#### 9、缓存穿透和雪崩
##### 缓存穿透
一个数据 缓存和mysql都没有  如果有大量的查询 会造成mysql崩溃
解决:布隆过滤器  缓存空对象

##### 缓存击穿
缓存过期时 大量的请求会直接请求到mysql

解决:数据不过期  分布式锁

##### 雪崩
缓存集中失效

解决:多设置几台缓存服务器  缓存失效，加锁或控制请求数量  预先测试大量请求的情况
